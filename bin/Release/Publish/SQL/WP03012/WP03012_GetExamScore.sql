select
	A.ID_TB_R_LEARN_EXAM_SCORE AS ID
	,ROW_NUMBER() OVER (ORDER BY B.REG_NO, (B.FIRST_NAME + ' '+ B.LAST_NAME), C.TITLE) RowNum
	,B.REG_NO
	,B.IDENTITY_NO
	,B.USERNAME
	,B.EMAIL
	,(B.FIRST_NAME + ' '+ B.LAST_NAME) AS [NAME]
	,C.TITLE
	,A.CORRECT_AMOUNT
	,A.WRONG_AMOUNT
	,A.NOT_ANSWERED_AMOUNT
	,A.REMEDIAL
	,A.SCORE
	,A.PASS_GRADUATED
	,A.TIMER
	,A.SUBMIT_DATE
from 
	TB_R_LEARN_EXAM_SCORE A
	LEFT JOIN TB_M_EMPLOYEE B ON A.ID_TB_M_EMPLOYEE = B.ID_TB_M_EMPLOYEE
	LEFT JOIN TB_R_LEARN_EXAM_SUBJECT C ON A.ID_TB_R_LEARN_EXAM_SUBJECT = C.ID_TB_R_LEARN_EXAM_SUBJECT
where
	(A.ID_TB_M_EMPLOYEE = '' + @ID_Employee + '' OR B.ID_TB_M_EMPLOYEE_ANZEN = '' + @ID_Employee + '') 
	AND B.REG_NO like '%' + @RegNo + '%'
	AND B.IDENTITY_NO like '%' + @IdentityNo + '%'
	AND B.USERNAME like '%' + @UserName + '%'
	AND B.EMAIL like '%' + @Email + '%'
order by
	A.SUBMIT_DATE, (B.FIRST_NAME + ' '+ B.LAST_NAME)

