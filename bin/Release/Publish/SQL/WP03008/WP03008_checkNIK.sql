SELECT 
A.FIRST_NAME,
A.LAST_NAME,
A.EMAIL,
A.ADDRESS,
A.PHONE,
CONVERT(char(10), A.SAFETY_INDUCTION_FROM,126) AS SAFETY_INDUCTION_FROM,
CONVERT(char(10), A.SAFETY_INDUCTION_TO,126) AS SAFETY_INDUCTION_TO,
A.SAFETY_INDUCTION_NO,
A.ID_TB_M_EMPLOYEE,
D.END_DATE,
A.REG_NO,
A.GENDER,
A.ID_TB_M_COMPANY AS ID_COMPANY,
(SELECT COMPANY_NAME FROM TB_M_COMPANY WHERE ID_TB_M_COMPANY = A.ID_TB_M_COMPANY) AS COMPANY_NAME,
A.IDENTITY_NO,
(
	CASE WHEN GETDATE() <= D.END_DATE THEN
		1
	ELSE
		0
	END
) STATUS_EMPLOYEE
FROM 
TB_M_EMPLOYEE AS A
LEFT JOIN  TB_R_WP_DAILY_WORKER_LIST AS B ON A.ID_TB_M_EMPLOYEE = B.TB_M_EMPLOYEE_ID
LEFT JOIN TB_R_WP_DAILY AS C ON B.TB_R_WP_DAILY_ID = C.ID
LEFT JOIN TB_R_WP_PROJECT_JOB AS D ON D.ID = C.TB_R_WP_PROJECT_JOB_ID
WHERE IDENTITY_NO = @NIK