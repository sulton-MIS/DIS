
<script>
    var GET_SITE_URL = (window.location.href).split('/');
    var SITE_URL = "";
    var Message = [];
    var scanQR = "";
    var HealtyCheck = false;
    var HealtyMessage = '';
    for (var i = 0; i < GET_SITE_URL.length; i++) {
        if (GET_SITE_URL[i] != "WPMember") {
            SITE_URL = SITE_URL + GET_SITE_URL[i] + "/";
        }
    }
    //Get Message From TB_M_MESSAGE
    $.ajax({
        url: "Message/GenerateMessage",
        success: function (e) {
            Message = e.res;
        },
        error: function (e) {
            toastr.error('Generate Message Error, Not Instance to the Object');
        }
    });
    

    $(document).ready(function () {
        //$('.menu-panel').click(function (e) {
        //    var getMenu = $(this).attr('data-target');
        //    (getMenu == "DASHBOARD") ? DASHBOARD() : (getMenu == "SCAN") ? SCAN() : DATA();

        //    $.ajax({
        //        url: SITE_URL + 'HealtyCheck',
        //        dataType: 'JSON',
        //        async: false,
        //        success: function (e) {
        //            if (e.data.length > 0) {
        //                HealtyCheck = true;
        //                HealtyMessage = e.data[0].MESSAGE_TEXT;
        //            }
        //        }
        //    });
        //});

        $('#data-container').show();

        //$('.button-back').click(function () {
        //    $('#menu-container').show();
        //    $('#scan-container').hide();
        //    $('#data-container').hide();
        //});

        getTabelOpmj();
    });

    //Generate Message
    function GenerateMessage(M, Text) {
        for (var i = 0; i < Message.length; i++) {
            var MSG_ID = Message[i].MSG_ID;
            var MSG_TXT = (Message[i].MSG_TEXT).split('{0}');

            if (MSG_ID == M) {
                var NEW_TXT = "";
                for (var e = 0; e < MSG_TXT.length; e++) {
                    if (e < (MSG_TXT.length - 1)) {
                        NEW_TXT = NEW_TXT + MSG_TXT[e] + " " + M;
                    } else {
                        NEW_TXT = NEW_TXT + " " + MSG_TXT[e];
                    }
                }
                return NEW_TXT;
            }
        }
    }

 
    function getTabelOpmj() {        
        var NIK = localStorage.getItem('searchNik') || $('#searchNik').val();
        var NAMA = localStorage.getItem('searchNama') || $('#searchNama').val();
        var GRP = localStorage.getItem('searchGroup') || $('#searchGroup').val();
        var MDATE = localStorage.getItem('searchMDate') || $('#searchMDate').val();
        var HALTE = localStorage.getItem('searchHalte') || $('#searchHalte').val();

        $('#searchNik').val(NIK).change(function () {            
            var val = $(this).val();
            localStorage.setItem('searchNik', val);
        });

        $('#searchNama').val(NAMA).change(function () {
            var val = $(this).val();
            localStorage.setItem('searchNama', val);
        });

        $('#searchGroup').val(GRP).change(function () {
            var val = $(this).val();            
            localStorage.setItem('searchGroup', val);
        });

        $('#searchMDate').val(MDATE).change(function () {
            var val = $(this).val();
            localStorage.setItem('searchMDate', val);                        

        });

        $('#searchHalte').val(HALTE).change(function () {
            var val = $(this).val();
            localStorage.setItem('searchHalte', val);

        });

        (function () {
           
            //var val = console.log(MDATE);
          
            var logger = document.getElementById('log');                        

            const monthNames = ["", "JANUARI", "FEBRUARI", "MARET", "APRIL", "MEI", "JUNI",
                "JULI", "AGUSTUS", "SEPTEMBER", "OKTOBER", "NOVEMBER", "DESEMBER"
            ];            

            //ambil format bulan saja
            var bulan = MDATE.substring(4);
            //ambil format tahun saja
            var tahun = MDATE.substring(0,4);
            //menghilangkan 0 didepan
            const withoutLeading0 = parseInt(bulan, 10);
            var month = monthNames[withoutLeading0];

            //logger.innerHTML = month + '-' + tahun;

            if (bulan != 0){
                logger.innerHTML = month + '-' + tahun;
            } else {
                logger.innerHTML = '';
            }

            console.log(month);
       
        })();

        $('#tabel-contractor').DataTable().destroy();
        var table = $('#tabel-contractor').DataTable({            
            
            //searching: false, paging: false, info: false,   
            destroy: true,    //ADD DESTROY TRUE
            scrollY: "800px",
            scrollX: true,
            //scrollCollapse: true,            
            //fixedColumns: {
            //    left: 1,
            //    right: 1
            //},
            "oLanguage": {

                "sSearch": "Quick Search:"

            },
            ajax: {
                url: SITE_URL + 'GetOpmj',
                method: 'POST',
                data: {                    
                    NIK: NIK,
                    NAMA: NAMA,
                    GRP: GRP,
                    MDATE: MDATE,
                    HALTE: HALTE
                },
                global: false
            },
            
            aLengthMenu: [
                [50, 100, 200, -1],
                [50, 100, 200, "All"]
            ],
            
            columns: [             
                { data: 'NIK', name: 'NIK' },
                { data: 'NAMA', name: 'NAMA' },
                { data: 'GRP', name: 'GRP' },
                { data: 'HALTE', name: 'HALTE' },
                { data: 'HARI_01', name: 'HARI_01' },
                { data: 'HARI_02', name: 'HARI_02' },
                { data: 'HARI_03', name: 'HARI_03' },
                { data: 'HARI_04', name: 'HARI_04' },
                { data: 'HARI_05', name: 'HARI_05' },
                { data: 'HARI_06', name: 'HARI_06' },
                { data: 'HARI_07', name: 'HARI_07' },
                { data: 'HARI_08', name: 'HARI_08' },
                { data: 'HARI_09', name: 'HARI_09' },
                { data: 'HARI_10', name: 'HARI_10' },
                { data: 'HARI_11', name: 'HARI_11' },
                { data: 'HARI_12', name: 'HARI_12' },
                { data: 'HARI_13', name: 'HARI_13' },
                { data: 'HARI_14', name: 'HARI_14' },
                { data: 'HARI_15', name: 'HARI_15' },
                { data: 'HARI_16', name: 'HARI_16' },
                { data: 'HARI_17', name: 'HARI_17' },
                { data: 'HARI_18', name: 'HARI_18' },
                { data: 'HARI_19', name: 'HARI_19' },
                { data: 'HARI_20', name: 'HARI_20' },
                { data: 'HARI_21', name: 'HARI_21' },
                { data: 'HARI_22', name: 'HARI_22' },
                { data: 'HARI_23', name: 'HARI_23' },
                { data: 'HARI_24', name: 'HARI_24' },
                { data: 'HARI_25', name: 'HARI_25' },
                { data: 'HARI_26', name: 'HARI_26' },
                { data: 'HARI_27', name: 'HARI_27' },
                { data: 'HARI_28', name: 'HARI_28' },
                { data: 'HARI_29', name: 'HARI_29' },
                { data: 'HARI_30', name: 'HARI_30' },
                { data: 'HARI_31', name: 'HARI_31' },

            ],            
            data: table,
          
            "createdRow": function (row, data) {

                $('td', row).eq(4).text(data.HARI_01 + ' %');
                $('td', row).eq(5).text(data.HARI_02 + ' %');
                $('td', row).eq(6).text(data.HARI_03 + ' %');
                $('td', row).eq(7).text(data.HARI_04 + ' %');
                $('td', row).eq(8).text(data.HARI_05 + ' %');
                $('td', row).eq(9).text(data.HARI_06 + ' %');
                $('td', row).eq(10).text(data.HARI_07 + ' %');
                $('td', row).eq(11).text(data.HARI_08 + ' %');
                $('td', row).eq(12).text(data.HARI_09 + ' %');
                $('td', row).eq(13).text(data.HARI_10 + ' %');
                $('td', row).eq(14).text(data.HARI_11 + ' %');
                $('td', row).eq(15).text(data.HARI_12 + ' %');
                $('td', row).eq(16).text(data.HARI_13 + ' %');
                $('td', row).eq(17).text(data.HARI_14 + ' %');
                $('td', row).eq(18).text(data.HARI_15 + ' %');
                $('td', row).eq(19).text(data.HARI_16 + ' %');
                $('td', row).eq(20).text(data.HARI_17 + ' %');
                $('td', row).eq(21).text(data.HARI_18 + ' %');
                $('td', row).eq(22).text(data.HARI_19 + ' %');
                $('td', row).eq(23).text(data.HARI_20 + ' %');
                $('td', row).eq(24).text(data.HARI_21 + ' %');                
                $('td', row).eq(25).text(data.HARI_22 + ' %');
                $('td', row).eq(26).text(data.HARI_23 + ' %');
                $('td', row).eq(27).text(data.HARI_24 + ' %');
                $('td', row).eq(28).text(data.HARI_25 + ' %');
                $('td', row).eq(29).text(data.HARI_26 + ' %');
                $('td', row).eq(30).text(data.HARI_27 + ' %');
                $('td', row).eq(31).text(data.HARI_28 + ' %');
                $('td', row).eq(32).text(data.HARI_29 + ' %');
                $('td', row).eq(33).text(data.HARI_30 + ' %');
                $('td', row).eq(34).text(data.HARI_31 + ' %');


                if (data.HARI_01 > 0 && data.HARI_01 <= 5) {
                    $('td', row).eq(4).addClass('highlight-blue');                   
                } else if (data.HARI_01 > 5 && data.HARI_01 <= 10) {
                    $('td', row).eq(4).addClass('highlight-yellow');                    
                } else if (data.HARI_01 > 10) {
                    $('td', row).eq(4).addClass('highlight-red');                    
                } else if (data.HARI_01 <= 0) {                    
                    $('td', row).eq(4).text("-");                   
                }

                if (data.HARI_02 > 0 && data.HARI_02 <= 5) {
                    $('td', row).eq(5).addClass('highlight-blue');
                } else if (data.HARI_02 > 5 && data.HARI_02 <= 10) {
                    $('td', row).eq(5).addClass('highlight-yellow');
                } else if (data.HARI_02 > 10) {
                    $('td', row).eq(5).addClass('highlight-red');
                } else if (data.HARI_02 <= 0) {
                    $('td', row).eq(5).text("-");
                }

                if (data.HARI_03 > 0 && data.HARI_03 <= 5) {
                    $('td', row).eq(6).addClass('highlight-blue');
                } else if (data.HARI_03 > 5 && data.HARI_03 <= 10) {
                    $('td', row).eq(6).addClass('highlight-yellow');
                } else if (data.HARI_03 > 10) {
                    $('td', row).eq(6).addClass('highlight-red');
                } else if (data.HARI_03 <= 0) {
                    $('td', row).eq(6).text("-");
                }

                if (data.HARI_04 > 0 && data.HARI_04 <= 5) {
                    $('td', row).eq(7).addClass('highlight-blue');
                } else if (data.HARI_04 > 5 && data.HARI_04 <= 10) {
                    $('td', row).eq(7).addClass('highlight-yellow');
                } else if (data.HARI_04 > 10) {
                    $('td', row).eq(7).addClass('highlight-red');
                } else if (data.HARI_04 <= 0) {
                    $('td', row).eq(7).text("-");
                }

                if (data.HARI_05 > 0 && data.HARI_05 <= 5) {
                    $('td', row).eq(8).addClass('highlight-blue');
                } else if (data.HARI_05 > 5 && data.HARI_05 <= 10) {
                    $('td', row).eq(8).addClass('highlight-yellow');
                } else if (data.HARI_05 > 10) {
                    $('td', row).eq(8).addClass('highlight-red');
                } else if (data.HARI_05 <= 0) {
                    $('td', row).eq(8).text("-");
                }

                if (data.HARI_06 > 0 && data.HARI_06 <= 5) {
                    $('td', row).eq(9).addClass('highlight-blue');
                } else if (data.HARI_06 > 5 && data.HARI_06 <= 10) {
                    $('td', row).eq(9).addClass('highlight-yellow');
                } else if (data.HARI_06 > 10) {
                    $('td', row).eq(9).addClass('highlight-red');
                } else if (data.HARI_06 <= 0) {
                    $('td', row).eq(9).text("-");
                }

                if (data.HARI_07 > 0 && data.HARI_07 <= 5) {
                    $('td', row).eq(10).addClass('highlight-blue');
                } else if (data.HARI_07 > 5 && data.HARI_07 <= 10) {
                    $('td', row).eq(10).addClass('highlight-yellow');
                } else if (data.HARI_07 > 10) {
                    $('td', row).eq(10).addClass('highlight-red');
                } else if (data.HARI_07 <= 0) {
                    $('td', row).eq(10).text("-");
                }

                if (data.HARI_08 > 0 && data.HARI_08 <= 5) {
                    $('td', row).eq(11).addClass('highlight-blue');
                } else if (data.HARI_08 > 5 && data.HARI_08 <= 10) {
                    $('td', row).eq(11).addClass('highlight-yellow');
                } else if (data.HARI_08 > 10) {
                    $('td', row).eq(11).addClass('highlight-red');
                } else if (data.HARI_08 <= 0) {
                    $('td', row).eq(11).text("-");
                }

                if (data.HARI_09 > 0 && data.HARI_09 <= 5) {
                    $('td', row).eq(12).addClass('highlight-blue');
                } else if (data.HARI_09 > 5 && data.HARI_09 <= 10) {
                    $('td', row).eq(12).addClass('highlight-yellow');
                } else if (data.HARI_09 > 10) {
                    $('td', row).eq(12).addClass('highlight-red');
                } else if (data.HARI_09 <= 0) {
                    $('td', row).eq(12).text("-");
                }

                if (data.HARI_10 > 0 && data.HARI_10 <= 5) {
                    $('td', row).eq(13).addClass('highlight-blue');
                } else if (data.HARI_10 > 5 && data.HARI_10 <= 10) {
                    $('td', row).eq(13).addClass('highlight-yellow');
                } else if (data.HARI_10 > 10) {
                    $('td', row).eq(13).addClass('highlight-red');
                } else if (data.HARI_10 <= 0) {
                    $('td', row).eq(13).text("-");
                }

                if (data.HARI_11 > 0 && data.HARI_11 <= 5) {
                    $('td', row).eq(14).addClass('highlight-blue');
                } else if (data.HARI_11 > 5 && data.HARI_11 <= 10) {
                    $('td', row).eq(14).addClass('highlight-yellow');
                } else if (data.HARI_11 > 10) {
                    $('td', row).eq(14).addClass('highlight-red');
                } else if (data.HARI_11 <= 0) {
                    $('td', row).eq(14).text("-");
                }

                if (data.HARI_12 > 0 && data.HARI_12 <= 5) {
                    $('td', row).eq(15).addClass('highlight-blue');
                } else if (data.HARI_12 > 5 && data.HARI_12 <= 10) {
                    $('td', row).eq(15).addClass('highlight-yellow');
                } else if (data.HARI_12 > 10) {
                    $('td', row).eq(15).addClass('highlight-red');
                } else if (data.HARI_12 <= 0) {
                    $('td', row).eq(15).text("-");
                }

                if (data.HARI_13 > 0 && data.HARI_13 <= 5) {
                    $('td', row).eq(16).addClass('highlight-blue');
                } else if (data.HARI_13 > 5 && data.HARI_13 <= 10) {
                    $('td', row).eq(16).addClass('highlight-yellow');
                } else if (data.HARI_13 > 10) {
                    $('td', row).eq(16).addClass('highlight-red');
                } else if (data.HARI_13 <= 0) {
                    $('td', row).eq(16).text("-");
                }

                if (data.HARI_14 > 0 && data.HARI_14 <= 5) {
                    $('td', row).eq(17).addClass('highlight-blue');
                } else if (data.HARI_14 > 5 && data.HARI_14 <= 10) {
                    $('td', row).eq(17).addClass('highlight-yellow');
                } else if (data.HARI_14 > 10) {
                    $('td', row).eq(17).addClass('highlight-red');
                } else if (data.HARI_14 <= 0) {
                    $('td', row).eq(17).text("-");
                }

                if (data.HARI_15 > 0 && data.HARI_15 <= 5) {
                    $('td', row).eq(18).addClass('highlight-blue');
                } else if (data.HARI_15 > 5 && data.HARI_15 <= 10) {
                    $('td', row).eq(18).addClass('highlight-yellow');
                } else if (data.HARI_15 > 10) {
                    $('td', row).eq(18).addClass('highlight-red');
                } else if (data.HARI_15 <= 0) {
                    $('td', row).eq(18).text("-");
                }

                if (data.HARI_16 > 0 && data.HARI_16 <= 5) {
                    $('td', row).eq(19).addClass('highlight-blue');
                } else if (data.HARI_16 > 5 && data.HARI_16 <= 10) {
                    $('td', row).eq(19).addClass('highlight-yellow');
                } else if (data.HARI_16 > 10) {
                    $('td', row).eq(19).addClass('highlight-red');
                } else if (data.HARI_16 <= 0) {
                    $('td', row).eq(19).text("-");
                }

                if (data.HARI_17 > 0 && data.HARI_17 <= 5) {
                    $('td', row).eq(20).addClass('highlight-blue');
                } else if (data.HARI_17 > 5 && data.HARI_17 <= 10) {
                    $('td', row).eq(20).addClass('highlight-yellow');
                } else if (data.HARI_17 > 10) {
                    $('td', row).eq(20).addClass('highlight-red');
                } else if (data.HARI_17 <= 0) {
                    $('td', row).eq(20).text("-");
                }

                if (data.HARI_18 > 0 && data.HARI_18 <= 5) {
                    $('td', row).eq(21).addClass('highlight-blue');
                } else if (data.HARI_18 > 5 && data.HARI_18 <= 10) {
                    $('td', row).eq(21).addClass('highlight-yellow');
                } else if (data.HARI_18 > 10) {
                    $('td', row).eq(21).addClass('highlight-red');
                } else if (data.HARI_18 <= 0) {
                    $('td', row).eq(21).text("-");
                }

                if (data.HARI_19 > 0 && data.HARI_19 <= 5) {
                    $('td', row).eq(22).addClass('highlight-blue');
                } else if (data.HARI_19 > 5 && data.HARI_19 <= 10) {
                    $('td', row).eq(22).addClass('highlight-yellow');
                } else if (data.HARI_19 > 10) {
                    $('td', row).eq(22).addClass('highlight-red');
                } else if (data.HARI_19 <= 0) {
                    $('td', row).eq(22).text("-");
                }

                if (data.HARI_20 > 0 && data.HARI_20 <= 5) {
                    $('td', row).eq(23).addClass('highlight-blue');
                } else if (data.HARI_20 > 5 && data.HARI_20 <= 10) {
                    $('td', row).eq(23).addClass('highlight-yellow');
                } else if (data.HARI_20 > 10) {
                    $('td', row).eq(23).addClass('highlight-red');
                } else if (data.HARI_20 <= 0) {
                    $('td', row).eq(23).text("-");
                }

                if (data.HARI_21 > 0 && data.HARI_21 <= 5) {
                    $('td', row).eq(24).addClass('highlight-blue');
                } else if (data.HARI_21 > 5 && data.HARI_21 <= 10) {
                    $('td', row).eq(24).addClass('highlight-yellow');
                } else if (data.HARI_21 > 10) {
                    $('td', row).eq(24).addClass('highlight-red');
                } else if (data.HARI_21 <= 0) {
                    $('td', row).eq(24).text("-");
                }

                if (data.HARI_22 > 0 && data.HARI_22 <= 5) {
                    $('td', row).eq(25).addClass('highlight-blue');
                } else if (data.HARI_22 > 5 && data.HARI_22 <= 10) {
                    $('td', row).eq(25).addClass('highlight-yellow');
                } else if (data.HARI_22 > 10) {
                    $('td', row).eq(25).addClass('highlight-red');
                } else if (data.HARI_22 <= 0) {
                    $('td', row).eq(25).text("-");
                }

                if (data.HARI_23 > 0 && data.HARI_23 <= 5) {
                    $('td', row).eq(26).addClass('highlight-blue');
                } else if (data.HARI_23 > 5 && data.HARI_23 <= 10) {
                    $('td', row).eq(26).addClass('highlight-yellow');
                } else if (data.HARI_23 > 10) {
                    $('td', row).eq(26).addClass('highlight-red');
                } else if (data.HARI_23 <= 0) {
                    $('td', row).eq(26).text("-");
                }

                if (data.HARI_24 > 0 && data.HARI_24 <= 5) {
                    $('td', row).eq(27).addClass('highlight-blue');
                } else if (data.HARI_24 > 5 && data.HARI_24 <= 10) {
                    $('td', row).eq(27).addClass('highlight-yellow');
                } else if (data.HARI_24 > 10) {
                    $('td', row).eq(27).addClass('highlight-red');
                } else if (data.HARI_24 <= 0) {
                    $('td', row).eq(27).text("-");
                }

                if (data.HARI_25 > 0 && data.HARI_25 <= 5) {
                    $('td', row).eq(28).addClass('highlight-blue');
                } else if (data.HARI_25 > 5 && data.HARI_25 <= 10) {
                    $('td', row).eq(28).addClass('highlight-yellow');
                } else if (data.HARI_25 > 10) {
                    $('td', row).eq(28).addClass('highlight-red');
                } else if (data.HARI_25 <= 0) {
                    $('td', row).eq(28).text("-");
                }

                if (data.HARI_26 > 0 && data.HARI_26 <= 5) {
                    $('td', row).eq(29).addClass('highlight-blue'); 
                } else if (data.HARI_26 > 5 && data.HARI_26 <= 10) {
                    $('td', row).eq(29).addClass('highlight-yellow');
                } else if (data.HARI_26 > 10) {
                    $('td', row).eq(29).addClass('highlight-red');
                } else if (data.HARI_26 <= 0) {
                    $('td', row).eq(29).text("-");
                }

                if (data.HARI_27 > 0 && data.HARI_27 <= 5) {
                    $('td', row).eq(30).addClass('highlight-blue');
                } else if (data.HARI_27 > 5 && data.HARI_27 <= 10) {
                    $('td', row).eq(30).addClass('highlight-yellow');
                } else if (data.HARI_27 > 10) {
                    $('td', row).eq(30).addClass('highlight-red');
                } else if (data.HARI_27 <= 0) {
                    $('td', row).eq(30).text("-");
                }

                if (data.HARI_28 > 0 && data.HARI_28 <= 5) {
                    $('td', row).eq(31).addClass('highlight-blue');
                } else if (data.HARI_28 > 5 && data.HARI_28 <= 10) {
                    $('td', row).eq(31).addClass('highlight-yellow');
                } else if (data.HARI_28 > 10) {
                    $('td', row).eq(31).addClass('highlight-red');
                } else if (data.HARI_28 <= 0) {
                    $('td', row).eq(31).text("-");
                }

                if (data.HARI_29 > 0 && data.HARI_29 <= 5) {
                    $('td', row).eq(32).addClass('highlight-blue');
                } else if (data.HARI_29 > 5 && data.HARI_29 <= 10) {
                    $('td', row).eq(32).addClass('highlight-yellow');
                } else if (data.HARI_29 > 10) {
                    $('td', row).eq(32).addClass('highlight-red');
                } else if (data.HARI_29 <= 0) {
                    $('td', row).eq(32).text("-");
                }

                if (data.HARI_30 > 0 && data.HARI_30 <= 5) {
                    $('td', row).eq(33).addClass('highlight-blue');
                } else if (data.HARI_30 > 5 && data.HARI_30 <= 10) {
                    $('td', row).eq(33).addClass('highlight-yellow');
                } else if (data.HARI_30 > 10) {
                    $('td', row).eq(33).addClass('highlight-red');
                } else if (data.HARI_30 <= 0) {
                    $('td', row).eq(33).text("-");
                }

                if (data.HARI_31 > 0 && data.HARI_31 <= 5) {
                    $('td', row).eq(34).addClass('highlight-blue');
                } else if (data.HARI_31 > 5 && data.HARI_31 <= 10) {    
                    $('td', row).eq(34).addClass('highlight-yellow');
                } else if (data.HARI_31 > 10) {
                    $('td', row).eq(34).addClass('highlight-red');                    
                } else if (data.HARI_31 <= 0) {                    
                    $('td', row).eq(34).text("-");
                }
            },

        });
    }   

    setInterval(function () {
        table.ajax.reload();
    }, 30000);

    setInterval(getTabelOpmj, 30000);

    //$('#tabel-contractor').DataTable().destroy();

    $("#btnExport").on('click', function (e) {
        var tableresults = $('#tabel-contractor').dataTable();
        //bgcolor = '#87AFC6'
        var tab_text = "<table border='1px'>";
        var column = "<tr><th  bgcolor = '#87AFC6'>NIK</th><th  bgcolor = '#87AFC6'>NAMA</th><th  bgcolor = '#87AFC6'>GRP</th><th  bgcolor = '#87AFC6'>HALTE</th><th  bgcolor = '#87AFC6'>H 01</th><th  bgcolor = '#87AFC6'>H 02</th><th  bgcolor = '#87AFC6'>H 03</th><th  bgcolor = '#87AFC6'>H 04</th><th  bgcolor = '#87AFC6'>H 05</th><th  bgcolor = '#87AFC6'>H 06</th><th  bgcolor = '#87AFC6'>H 07</th><th  bgcolor = '#87AFC6'>H 08</th><th  bgcolor = '#87AFC6'>H 09</th><th  bgcolor = '#87AFC6'>H 10</th><th  bgcolor = '#87AFC6'>H 11</th><th  bgcolor = '#87AFC6'>H 12</th><th  bgcolor = '#87AFC6'>H 13</th><th  bgcolor = '#87AFC6'>H 14</th><th  bgcolor = '#87AFC6'>H 15</th><th  bgcolor = '#87AFC6'>H 16</th><th  bgcolor = '#87AFC6'>H 17</th><th  bgcolor = '#87AFC6'>H 18</th><th  bgcolor = '#87AFC6'>H 19</th><th  bgcolor = '#87AFC6'>H 20</th><th  bgcolor = '#87AFC6'>H 21</th><th  bgcolor = '#87AFC6'>H 22</th><th  bgcolor = '#87AFC6'>H 23</th><th  bgcolor = '#87AFC6'>H 24</th><th  bgcolor = '#87AFC6'>H 25</th><th  bgcolor = '#87AFC6'>H 26</th><th  bgcolor = '#87AFC6'>H 27</th><th  bgcolor = '#87AFC6'>H 28</th><th  bgcolor = '#87AFC6'>H 29</th><th  bgcolor = '#87AFC6'>H 30</th><th  bgcolor = '#87AFC6'>H 31</th></tr><tr>";
        tab_text = tab_text + column;
        var textRange; var j = 1;
        tab = document.getElementById('tabel-contractor'); // id of table

        for (j = 1; j < tab.rows.length; j++) {
            tab_text = tab_text + tab.rows[j].innerHTML + "</tr>";
            //tab_text=tab_text+"</tr>";
        }

        tab_text = tab_text + "</table>";
        tab_text = tab_text.replace(/<A[^>]*>|<\/A>/g, "");//remove if u want links in your table
        tab_text = tab_text.replace(/<img[^>]*>/gi, ""); // remove if u want images in your table
        tab_text = tab_text.replace(/<input[^>]*>|<\/input>/gi, ""); // reomves input params

        var ua = window.navigator.userAgent;
        var msie = ua.indexOf("MSIE ");

        if (msie > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./))      // If Internet Explorer
        {
            txtArea1.document.open("txt/html", "replace");
            txtArea1.document.write(tab_text);
            txtArea1.document.close();
            txtArea1.focus();
            sa = txtArea1.document.execCommand("SaveAs", true, "Say Thanks to Sumit.xls");
        }
        else                 //other browser not tested on IE 11
            sa = window.open('data:application/vnd.ms-excel,' + encodeURIComponent(tab_text));

        return (sa);
    });

    //function printEXCEL() {
    //    var NIK = $('#searchNik').val();
    //    var NAMA = $('#searchNama').val();
    //    var GRP = $('#searchGroup').val();
    //    var MDATE = $('#searchMDate').val();
    //    var HALTE = $('#searchHalte').val();

    //    window.open(
    //        'DISR170004/PrintExcel?NIK=' + NIK + '&NAMA=' + NAMA + '&GRP=' + GRP + '&MDATE=' + MDATE + '&HALTE=' + HALTE + '',
    //        '_blank' 
    //    );
    //}
 
    //Manual Book
    $("#openBook").click(function () {
        $("#modalManualBook").modal();
    });
    $("#closeBtn").click(function () {
        $("#modalManualBook").modal('hide');
    })

    //-----------File References---------
    //Doc. ROI
    $("#openFileRoi").click(function () {
        $("#modalFileRoi").modal();
    });
    $("#closeFileRoi").click(function () {
        $("#modalFileRoi").modal('hide');
    })

    //Doc. URD
    $("#openFileUrd").click(function () {
        $("#modalFileUrd").modal();
    });
    $("#closeFileUrd").click(function () {
        $("#modalFileUrd").modal('hide');
    })
    //Doc. FSD
    $("#openFileFsd").click(function () {
        $("#modalFileFsd").modal();
    });
    $("#closeFileFsd").click(function () {
        $("#modalFileFsd").modal('hide');
    })

    //Doc. Test
    $("#openFileTest").click(function () {
        $("#modalFileTest").modal();
    });
    $("#closeFileTest").click(function () {
        $("#modalFileTest").modal('hide');
    })

    //Doc. Training
    $("#openFileTraining").click(function () {
        $("#modalFileTraining").modal();
    });
    $("#closeFileTraining").click(function () {
        $("#modalFileTraining").modal('hide');
    })

    //Doc. Evaluase
    $("#openFileEvaluasi").click(function () {
        $("#modalFileEvaluasi").modal();
    });
    $("#closeFileEvaluasi").click(function () {
        $("#modalFileEvaluasi").modal('hide');
    })

         
</script>

