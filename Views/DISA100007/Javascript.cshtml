
<script>
    var SITE_URL = window.location.href + "/";
    var Message = [];

    var GET_SITE_URL = (window.location.href).split('/');
    var NEW_SITE_URL = "";

    for (var i = 0; i < GET_SITE_URL.length; i++) {
        if (GET_SITE_URL[i] != "DISA100007") {
            NEW_SITE_URL = NEW_SITE_URL + GET_SITE_URL[i] + "/";
        }
    }

    $(document).ready(function () {
        $('.menu-panel').click(function (e) {
            var getMenu = $(this).attr('data-target');
            var userLogin = $('#userLogin').val();
            var regLogin = $('#regLogin').val();

            //alert(regLogin);

            //Check User
            checkLogin(regLogin, getMenu);

        });

        $.ajax({
            url: "Message/GenerateMessage",
            success: function (e) {
                Message = e.res;

                for (var i = 0; i < Message.length; i++) {
                    var MSG_ID = Message[i].MSG_ID;
                    if (MSG_ID == "MWP005") {
                        $('#modal-save-tittle').text(Message[i].MSG_TEXT);
                    } else if (MSG_ID == "MWP006") {
                        $('#modal-delete-tittle').text(Message[i].MSG_TEXT);
                    } else if (MSG_ID == "MWP007") {
                        $('#modal-update-tittle').text(Message[i].MSG_TEXT);
                    }
                }
            }
        });
    });

    function GenerateMessage(M, Text) {
        for (var i = 0; i < Message.length; i++) {
            var MSG_ID = Message[i].MSG_ID;
            var MSG_TXT = (Message[i].MSG_TEXT).split('{0}');
            if (MSG_ID == Text) {
                var NEW_TXT = "";
                for (var e = 0; e < MSG_TXT.length; e++) {
                    if (e < (MSG_TXT.length - 1)) {
                        if (Array.isArray(M)) {
                            NEW_TXT = NEW_TXT + MSG_TXT[e] + " " + M[e];
                        } else {
                            NEW_TXT = NEW_TXT + MSG_TXT[e] + " " + M;
                        }

                    } else {
                        NEW_TXT = NEW_TXT + " " + MSG_TXT[e];
                    }
                }
                if (Text == 'MWP001' || Text == 'MWP003') {
                    toastr.success(NEW_TXT);
                } else if (Text == "MWP011" || Text == "MWP013" || Text == "MWP016" || Text == "MWP017") {
                    toastr.error(NEW_TXT);
                } else {
                    toastr.warning(NEW_TXT);
                }

            }
        }
    }

    //------------------------------------------------ USER CONTROL ------------------------------------
    function checkLogin(regLogin, getMenu) {
        var sts = true;
        var formMenu = getMenu;

        // Jika regLogin bukan "Super User" dan bukan "Admin Document Control",
        // maka akann cek Validasi Form
        if (regLogin == "SU" || regLogin == "ADC") {
            openForm(getMenu);
            sts = true;
        }
        else {
            $.ajax({
                type: "POST",
                url: SITE_URL + 'validasiOpenForm',
                async: false,
                data: {
                    formMenu: formMenu
                },
                success: function (res) {
                    if (res.sts == "TRUE") {
                        openForm(formMenu);
                    } else {
                        toastr.warning("Your Account Doesn't Have Access! Please Contact Administrator!");
                        sts = false;
                        return;
                    }
                },
                error: function (res) {
                    toastr.error(res.Message);
                    sts = false;
                }
            });

        }

        if (sts = false) {
            return;
        }
    }

    function openForm(getMenu) {
        (getMenu == "Waiting Approval Document") ? WAITING_APPROVAL() : (getMenu == "Master List Document") ? MASTER_DOCUMENT() :
            (getMenu == "List Pinjam Document") ? PINJAM_DOCUMENT() : (getMenu == "List Pengembalian Document") ? PENGEMBALIAN_DOCUMENT() : DATA();
    }

    function WAITING_APPROVAL() {
        var win = window.location.replace(SITE_URL + 'PAGE_WAITING_APPROVAL', '_blank');
        //var win = window.open(SITE_URL + 'REQ_ASSET', '_blank');
        win.focus();
    }

    function MASTER_DOCUMENT() {
        var win = window.location.replace(SITE_URL + 'PAGE_MASTER_DOCUMENT', '_blank');
        win.focus();
    }

    function PINJAM_DOCUMENT() {
        var win = window.location.replace(SITE_URL + 'PAGE_PINJAM_DOCUMENT', '_blank');
        win.focus();
    }

    function PENGEMBALIAN_DOCUMENT() {
        var win = window.location.replace(SITE_URL + 'PAGE_PENGEMBALIAN_DOCUMENT', '_blank');
        win.focus();
    }


    //------------------------------------------ DOCUMENT ----------------------------------------------
    //Manual Book
    $("#openBook").click(function () {
        $("#myModal").modal();
    });
    $("#closeBtn").click(function () {
        $("#myModal").modal('hide');
    })

    //--------------------------------------- FILE REFERENCES ------------------------------------------
    //Doc. ROI
    $("#openFileROI").click(function () {
        $("#modalFileROI").modal();
    });
    $("#closeFileROI").click(function () {
        $("#modalFileROI").modal('hide');
    })

    //Doc. URD
    $("#openFileURD").click(function () {
        $("#modalFileURD").modal();
    });
    $("#closeFileURD").click(function () {
        $("#modalFileURD").modal('hide');
    })

    //Doc. FSD
    $("#openFileFSD").click(function () {
        $("#modalFileFSD").modal();
    });
    $("#closeFileFSD").click(function () {
        $("#modalFileFSD").modal('hide');
    })

    //Doc. Test
    $("#openFileTest").click(function () {
        $("#modalFileTest").modal();
    });
    $("#closeFileTest").click(function () {
        $("#modalFileTest").modal('hide');
    })

    //Doc. Training
    $("#openFileTraining").click(function () {
        $("#modalFileTraining").modal();
    });
    $("#closeFileTraining").click(function () {
        $("#modalFileTraining").modal('hide');
    })

    //Doc. Training
    $("#openFileEvaluasi").click(function () {
        $("#modalFileEvaluasi").modal();
    });
    $("#closeFileEvaluasi").click(function () {
        $("#modalFileEvaluasi").modal('hide');
    })

</script>