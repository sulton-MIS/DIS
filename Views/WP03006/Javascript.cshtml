<script>
    //var examSubject = ""
    //var companyName = ""

    $(document).ready(function () {
        //reloadSummary()

        //OnSearch(1);

    });

    function back() {
        location.href = "/WP03006"
    }

    function refreshFilter() {
        RegNo = $('#searchRegNo').val();
        IdentityType = $('#searchIdentityType').val();
        IdentityNo = $('#searchIdentityNo').val();
        UserName = $('#searchUserName').val();
        Email = $('#searchEmail').val();
    }

    function OnSearch(page) {
        reloadSummary(page, $('#paging').val());

        $('#btn_download').prop('disabled', false);
        $('#btn_clear').prop('disabled', false);
    }

    function clear_search() {
        //$('#filter').load(window.location.href + " #filter");
        $('#searchRegNo').val('');
        $('#searchIdentityType').val('');
        $('#searchIdentityNo').val('');
        $('#searchUserName').val('');
        $('#searchEmail').val('');

        OnSearch(1);
    }

    function reloadSummary(page, size) {
        refreshFilter()

        $.ajax({
            type: "GET",
            url: 'WP03006/GetSummmaryData',
            async: false,
            data: {
                start: page,
                display: size,
                IdentityType: IdentityType,
                RegNo,
                IdentityNo,
                UserName,
                Email
            },
            success: function (data) {
                $('#main-data').html(data);
            }
        });
    }

    function printPDF() {
        refreshFilter()

        window.open(
            'WP03006/PrintPDF?RegNo=' + RegNo + '&searchIdentityType=' + searchIdentityType + '&IdentityNo=' + IdentityNo + '&UserName=' + UserName + '&Email=' + Email + '',
            '_blank' // <- This is what makes it open in a new window.
        );
    }

    function printEXCEL() {
        refreshFilter()

        window.open(
            'WP03006/PrintExcel?RegNo=' + RegNo + '&searchIdentityType=' + searchIdentityType + '&IdentityNo=' + IdentityNo + '&UserName=' + UserName + '&Email=' + Email + '',
            '_blank' // <- This is what makes it open in a new window.
        );
    }

    function printNameCardByIdEmployee(ctl) {

        _row = $(ctl).parents("tr");
        var cols = _row.children("td");
        var Id = cols[1].id;

        window.open(
            'WP03006/NameCard?id=' + id,
            '_blank' // <- This is what makes it open in a new window.
        );
    }

    function printCertifiedIdEmployee(ctl) {

        _row = $(ctl).parents("tr");
        var cols = _row.children("td");
        var Id = cols[1].id;
        window.open(
            'WP03006/Certified?id=' + id,
            '_blank' // <- This is what makes it open in a new window.
        );
    }

    function printNameCardByIdScore(ctl) {

        _row = $(ctl).parents("tr");
        var cols = _row.children("td");
        var Id = cols[1].id;

        window.open(
            'WP03006/NameCardByScore?id=' + id,
            '_blank' // <- This is what makes it open in a new window.
        );
    }

    function printCertifiedByIdScore(ctl) {

        _row = $(ctl).parents("tr");
        var cols = _row.children("td");
        var Id = cols[1].id;
        window.open(
            'WP03006/CertifiedByScore?id=' + id,
            '_blank' // <- This is what makes it open in a new window.
        );
    }

</script>